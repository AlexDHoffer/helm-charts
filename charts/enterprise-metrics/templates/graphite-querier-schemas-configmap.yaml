{{- if .Values.graphite.enabled -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "enterprise-metrics.fullname" . }}-graphite-schemas
  labels:
    app: {{ template "enterprise-metrics.name" . }}
    chart: {{ template "enterprise-metrics.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
data:
  storage-schemas.conf: |
    [default]
    pattern = {{ .Values.graphite_querier.schemasConfiguration.storageSchemas.pattern }}
    intervals = {{ .Values.graphite_querier.schemasConfiguration.storageSchemas.intervals }}
    retentions = {{ .Values.graphite_querier.schemasConfiguration.storageSchemas.retentions }}
  storage-aggregations.conf: |
    [default]
    aggregationMethod = {{ .Values.graphite_querier.schemasConfiguration.storageAggregations.aggregationMethod }}
    pattern = {{ .Values.graphite_querier.schemasConfiguration.storageAggregations.patern }}
    xFilesFactor = {{ .Values.graphite_querier.schemasConfiguration.storageAggregations.xFilesFactor }}
{{- end -}}
